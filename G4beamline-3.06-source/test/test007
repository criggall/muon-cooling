=tracking through a group of 2 solenoids (12 sec)
=require gsl

=file test007.in 
param histoFile=""
physics QGSP doStochastics=0
beam ascii filename=test007.beam nEvents=9
randomseed now 1
coil test007.coil innerRadius=200 outerRadius=300 length=500 \
		material=Cu
solenoid test007.solenoid coilName=test007.coil current=50.0
group 2solenoids length=2000
	place test007.solenoid z=-750 current=100
	place test007.solenoid z=750 current=-100
endgroup
place 2solenoids z=2000
virtualdetector format=BLTrackFile AF radius=200 length=1 file=test007.txt color=1,1,1
place AF z=4000
printfield type=print field=Bz layout=zx drow=50 dcol=40 \
		nrow=81 ncol=5
=file test007.beam 
#BLTrackFile test007 beam
#x y z Px Py Pz t PDGid EventID TrackID ParentID Weight
#cm cm cm MeV/c MeV/c MeV/c ns - - - - -
0.000 0.000 0.000 0.000 0.000 200.000 0.375 -13 0 1 0 1.0000
0.000 0.000 0.000 5.000 0.000 200.000 0.375 -13 1 1 0 2.0000
0.000 0.000 0.000 0.000 5.000 200.000 0.375 -13 2 1 0 2.0000
0.000 0.000 0.000 5.000 5.000 200.000 0.375 -13 3 1 0 3.0000
0.000 0.000 0.000 -5.000 0.000 200.000 0.375 -13 4 1 0 2.0000
0.000 0.000 0.000 0.000 -5.000 200.000 0.375 -13 5 1 0 2.0000
0.000 0.000 0.000 -5.000 -5.000 200.000 0.375 -13 6 1 0 3.0000
0.000 0.000 0.000 -5.000 5.000 200.000 0.375 -13 7 1 0 3.0000
0.000 0.000 0.000 5.000 -5.000 200.000 0.375 -13 8 1 0 3.0000
=file test007.good 
#BLTrackFile VirtualDetector/AF
#x y z Px Py Pz t PDGid EventID TrackID ParentID Weight
#mm mm mm MeV/c MeV/c MeV/c ns - - - - -
0.00 0.00 3999.50 0.000 0.000 200.000 15.463 -13 0 1 0 1.0000
12.98 0.02 3999.50 -3.854 0.129 200.026 15.510 -13 1 1 0 2.0000
-0.02 12.98 3999.50 -0.129 -3.854 200.026 15.510 -13 2 1 0 2.0000
6.97 6.76 3999.50 -4.545 -4.500 200.023 15.549 -13 3 1 0 3.0000
-12.98 -0.02 3999.50 3.854 -0.129 200.026 15.510 -13 4 1 0 2.0000
0.02 -12.98 3999.50 0.129 3.854 200.026 15.510 -13 5 1 0 2.0000
-6.97 -6.76 3999.50 4.545 4.500 200.023 15.549 -13 6 1 0 3.0000
-6.76 6.97 3999.50 4.500 -4.545 200.023 15.549 -13 7 1 0 3.0000
6.76 -6.97 3999.50 -4.500 4.545 200.023 15.549 -13 8 1 0 3.0000
=file test007.B 
z=0.0       0.0935   0.0931   0.0922   0.0907   0.0886
z=50.0      0.1064   0.1060   0.1049   0.1030   0.1005
z=100.0     0.1218   0.1213   0.1199   0.1175   0.1144
z=150.0     0.1401   0.1395   0.1378   0.1349   0.1310
z=200.0     0.1622   0.1614   0.1592   0.1556   0.1507
z=250.0     0.1891   0.1881   0.1853   0.1806   0.1744
z=300.0     0.2219   0.2206   0.2170   0.2110   0.2031
z=350.0     0.2625   0.2609   0.2561   0.2484   0.2381
z=400.0     0.3132   0.3110   0.3048   0.2947   0.2812
z=450.0     0.3774   0.3745   0.3661   0.3527   0.3347
z=500.0     0.4594   0.4554   0.4441   0.4260   0.4019
z=550.0     0.5658   0.5604   0.5449   0.5200   0.4872
z=600.0     0.7054   0.6979   0.6764   0.6420   0.5966
z=650.0     0.8915   0.8810   0.8508   0.8026   0.7392
z=700.0     1.1423   1.1277   1.0853   1.0173   0.9276
z=750.0     1.4838   1.4635   1.4044   1.3087   1.1809
z=800.0     1.9506   1.9235   1.8437   1.7113   1.5299
z=850.0     2.5818   2.5487   2.4486   2.2756   2.0243
z=900.0     3.4122   3.3788   3.2739   3.0778   2.7582
z=950.0     4.4358   4.4146   4.3445   4.1972   3.8989
z=1000.0    5.5793   5.5837   5.5965   5.6170   5.6447
z=1050.0    6.6958   6.7263   6.8233   7.0139   7.3702
z=1100.0    7.6340   7.6781   7.8139   8.0595   8.4448
z=1150.0    8.3150   8.3614   8.4998   8.7344   9.0670
z=1200.0    8.7111   8.7554   8.8853   9.0979   9.3857
z=1250.0    8.8407   8.8838   9.0093   9.2126   9.4841
z=1300.0    8.6991   8.7435   8.8735   9.0862   9.3744
z=1350.0    8.2908   8.3372   8.4759   8.7109   9.0442
z=1400.0    7.5969   7.6412   7.7774   8.0237   8.4099
z=1450.0    6.6450   6.6757   6.7733   6.9648   7.3224
z=1500.0    5.5136   5.5183   5.5318   5.5537   5.5830
z=1550.0    4.3536   4.3327   4.2636   4.1180   3.8220
z=1600.0    3.3113   3.2784   3.1748   2.9808   2.6641
z=1650.0    2.4594   2.4269   2.3286   2.1582   1.9106
z=1700.0    1.8034   1.7770   1.6993   1.5705   1.3937
z=1750.0    1.3070   1.2876   1.2313   1.1401   1.0184
z=1800.0    0.9301   0.9167   0.8779   0.8157   0.7339
z=1850.0    0.6361   0.6273   0.6018   0.5612   0.5080
z=1900.0    0.3969   0.3916   0.3763   0.3520   0.3201
z=1950.0    0.1907   0.1882   0.1811   0.1697   0.1547
z=2000.0    0.0000   0.0000   0.0000   0.0000   0.0000
z=2050.0   -0.1907  -0.1882  -0.1811  -0.1697  -0.1547
z=2100.0   -0.3969  -0.3916  -0.3763  -0.3520  -0.3201
z=2150.0   -0.6361  -0.6273  -0.6018  -0.5612  -0.5080
z=2200.0   -0.9301  -0.9167  -0.8779  -0.8157  -0.7339
z=2250.0   -1.3070  -1.2876  -1.2313  -1.1401  -1.0184
z=2300.0   -1.8034  -1.7770  -1.6993  -1.5705  -1.3937
z=2350.0   -2.4594  -2.4269  -2.3286  -2.1582  -1.9106
z=2400.0   -3.3113  -3.2784  -3.1748  -2.9808  -2.6641
z=2450.0   -4.3536  -4.3327  -4.2636  -4.1180  -3.8220
z=2500.0   -5.5136  -5.5183  -5.5318  -5.5537  -5.5830
z=2550.0   -6.6450  -6.6757  -6.7733  -6.9648  -7.3224
z=2600.0   -7.5969  -7.6412  -7.7774  -8.0237  -8.4099
z=2650.0   -8.2908  -8.3372  -8.4759  -8.7109  -9.0442
z=2700.0   -8.6991  -8.7435  -8.8735  -9.0862  -9.3744
z=2750.0   -8.8407  -8.8838  -9.0093  -9.2126  -9.4841
z=2800.0   -8.7111  -8.7554  -8.8853  -9.0979  -9.3857
z=2850.0   -8.3150  -8.3614  -8.4998  -8.7344  -9.0670
z=2900.0   -7.6340  -7.6781  -7.8139  -8.0595  -8.4448
z=2950.0   -6.6958  -6.7263  -6.8233  -7.0139  -7.3702
z=3000.0   -5.5793  -5.5837  -5.5965  -5.6170  -5.6447
z=3050.0   -4.4358  -4.4146  -4.3445  -4.1972  -3.8989
z=3100.0   -3.4122  -3.3788  -3.2739  -3.0778  -2.7582
z=3150.0   -2.5818  -2.5487  -2.4486  -2.2756  -2.0243
z=3200.0   -1.9506  -1.9235  -1.8437  -1.7113  -1.5299
z=3250.0   -1.4838  -1.4635  -1.4044  -1.3087  -1.1809
z=3300.0   -1.1423  -1.1277  -1.0853  -1.0173  -0.9276
z=3350.0   -0.8915  -0.8810  -0.8508  -0.8026  -0.7392
z=3400.0   -0.7054  -0.6979  -0.6764  -0.6420  -0.5966
z=3450.0   -0.5658  -0.5604  -0.5449  -0.5200  -0.4872
z=3500.0   -0.4594  -0.4554  -0.4441  -0.4260  -0.4019
z=3550.0   -0.3774  -0.3745  -0.3661  -0.3527  -0.3347
z=3600.0   -0.3132  -0.3110  -0.3048  -0.2947  -0.2812
z=3650.0   -0.2625  -0.2609  -0.2561  -0.2484  -0.2381
z=3700.0   -0.2219  -0.2206  -0.2170  -0.2110  -0.2031
z=3750.0   -0.1891  -0.1881  -0.1853  -0.1806  -0.1744
z=3800.0   -0.1622  -0.1614  -0.1592  -0.1556  -0.1507
z=3850.0   -0.1401  -0.1395  -0.1378  -0.1349  -0.1310
z=3900.0   -0.1218  -0.1213  -0.1199  -0.1175  -0.1144
z=3950.0   -0.1064  -0.1060  -0.1049  -0.1030  -0.1005
z=4000.0   -0.0935  -0.0931  -0.0922  -0.0907  -0.0886
=run g4bl test007.in 
=grep "^z" g4bl.out test007.try
=compare test007.B test007.try -1 0.02 0.02 0.02 0.02 0.02
=compare test007.txt test007.good 0.1 0.1 0.1 0.1 0.1 0.1 0.1
