=field of rotated solenoid (7 sec)
=require gsl

=file test021.in 
param histoFile=""
physics QGSP doStochastics=0
beam ascii filename=test021.beam nEvents=9
randomseed now 1
coil test021.coil innerRadius=200 outerRadius=300 length=500 \
	material=Cu tolerance=0.005
solenoid test021.solenoid coilName=test021.coil current=50.0
place test021.solenoid z=2.1 rotation=X43,Y47
printfield type=print field=Bx layout=zx y=0 drow=20 dcol=20 \
	nrow=10 ncol=10
printfield type=print field=By layout=zx y=0 drow=20 dcol=20 \
	nrow=10 ncol=10
printfield type=print field=Bz layout=zx y=0 drow=20 dcol=20 \
	nrow=10 ncol=10
printfield type=print field=Bx layout=zx y=100 drow=20 dcol=20 \
	nrow=10 ncol=10
printfield type=print field=By layout=zx y=100 drow=20 dcol=20 \
	nrow=10 ncol=10
printfield type=print field=Bz layout=zx y=100 drow=20 dcol=20 \
	nrow=10 ncol=10 exit=1
=file test021.in2 
param histoFile=""
physics QGSP doStochastics=0
beam ascii filename=test021.beam nEvents=9
randomseed now 1
coil test021.coil innerRadius=200 outerRadius=300 length=500 \
	material=Cu tolerance=0.005
solenoid test021.solenoid coilName=test021.coil current=50.0
corner Rot z=2.1 rotation=X43,Y47
place test021.solenoid z=2.1
printfield type=print field=Bx layout=zx y=0 drow=20 dcol=20 \
	nrow=10 ncol=10
printfield type=print field=By layout=zx y=0 drow=20 dcol=20 \
	nrow=10 ncol=10
printfield type=print field=Bz layout=zx y=0 drow=20 dcol=20 \
	nrow=10 ncol=10
printfield type=print field=Bx layout=zx y=100 drow=20 dcol=20 \
	nrow=10 ncol=10
printfield type=print field=By layout=zx y=100 drow=20 dcol=20 \
	nrow=10 ncol=10
printfield type=print field=Bz layout=zx y=100 drow=20 dcol=20 \
	nrow=10 ncol=10 exit=1
=file test021.beam 
#BLTrackFile test021 beam
#x y z Px Py Pz t PDGid EventID TrackID ParentID Weight
#cm cm cm MeV/c MeV/c MeV/c ns - - - - -
0.000 0.000 0.000 0.000 0.000 200.000 0.375 -13 0 1 0 1.0000
0.000 0.000 0.000 5.000 0.000 200.000 0.375 -13 1 1 0 2.0000
0.000 0.000 0.000 0.000 5.000 200.000 0.375 -13 2 1 0 2.0000
0.000 0.000 0.000 5.000 5.000 200.000 0.375 -13 3 1 0 3.0000
0.000 0.000 0.000 -5.000 0.000 200.000 0.375 -13 4 1 0 2.0000
0.000 0.000 0.000 0.000 -5.000 200.000 0.375 -13 5 1 0 2.0000
0.000 0.000 0.000 -5.000 -5.000 200.000 0.375 -13 6 1 0 3.0000
0.000 0.000 0.000 -5.000 5.000 200.000 0.375 -13 7 1 0 3.0000
0.000 0.000 0.000 5.000 -5.000 200.000 0.375 -13 8 1 0 3.0000
=file test021.B 
0.0       2.3802   2.3838   2.3989   2.4199   2.4522   2.4906   2.5415   2.5989   2.6681   2.7453
20.0      2.3788   2.3820   2.3926   2.4137   2.4414   2.4814   2.5283   2.5867   2.6533   2.7331
40.0      2.3780   2.3772   2.3870   2.4043   2.4319   2.4682   2.5155   2.5707   2.6386   2.7171
60.0      2.3739   2.3723   2.3786   2.3953   2.4197   2.4553   2.4995   2.5552   2.6207   2.7011
80.0      2.3698   2.3645   2.3697   2.3835   2.4077   2.4395   2.4838   2.5370   2.6028   2.6817
100.0     2.3636   2.3579   2.3601   2.3720   2.3927   2.4249   2.4652   2.5192   2.5830   2.6626
120.0     2.3584   2.3496   2.3500   2.3594   2.3788   2.4071   2.4483   2.4988   2.5639   2.6409
140.0     2.3525   2.3411   2.3389   2.3462   2.3637   2.3914   2.4291   2.4800   2.5429   2.6222
160.0     2.3465   2.3327   2.3275   2.3327   2.3479   2.3743   2.4116   2.4604   2.5233   2.6026
180.0     2.3421   2.3244   2.3184   2.3209   2.3345   2.3577   2.3935   2.4424   2.5054   2.5842
0.0      -3.0348  -3.0329  -3.0314  -3.0232  -3.0153  -3.0010  -2.9896  -2.9725  -2.9584  -2.9395
20.0     -3.0330  -3.0240  -3.0099  -2.9950  -2.9738  -2.9547  -2.9297  -2.9062  -2.8773  -2.8526
40.0     -3.0320  -3.0112  -2.9893  -2.9624  -2.9342  -2.9025  -2.8707  -2.8333  -2.7973  -2.7589
60.0     -3.0268  -2.9982  -2.9650  -2.9306  -2.8909  -2.8509  -2.8065  -2.7616  -2.7118  -2.6656
80.0     -3.0217  -2.9816  -2.9402  -2.8949  -2.8479  -2.7950  -2.7428  -2.6852  -2.6261  -2.5651
100.0    -3.0138  -2.9666  -2.9145  -2.8597  -2.8006  -2.7407  -2.6742  -2.6088  -2.5365  -2.4639
120.0    -3.0071  -2.9495  -2.8883  -2.8230  -2.7546  -2.6812  -2.6077  -2.5271  -2.4459  -2.3558
140.0    -2.9995  -2.9322  -2.8606  -2.7854  -2.7066  -2.6239  -2.5359  -2.4459  -2.3491  -2.2483
160.0    -2.9920  -2.9150  -2.8325  -2.7468  -2.6568  -2.5635  -2.4649  -2.3600  -2.2496  -2.1322
180.0    -2.9863  -2.8979  -2.8076  -2.7105  -2.6096  -2.5014  -2.3897  -2.2719  -2.1458  -2.0074
0.0       2.2196   2.2176   2.2159   2.2093   2.2030   2.1919   2.1830   2.1700   2.1591   2.1447
20.0      2.2224   2.2209   2.2156   2.2097   2.1993   2.1903   2.1771   2.1648   2.1487   2.1356
40.0      2.2363   2.2318   2.2265   2.2177   2.2079   2.1955   2.1829   2.1665   2.1512   2.1343
60.0      2.2576   2.2531   2.2454   2.2368   2.2245   2.2120   2.1965   2.1807   2.1620   2.1459
80.0      2.2891   2.2823   2.2745   2.2640   2.2524   2.2369   2.2219   2.2037   2.1851   2.1659
100.0     2.3288   2.3227   2.3134   2.3023   2.2884   2.2740   2.2559   2.2388   2.2183   2.1991
120.0     2.3789   2.3717   2.3623   2.3503   2.3364   2.3197   2.3033   2.2835   2.2646   2.2425
140.0     2.4379   2.4306   2.4208   2.4088   2.3948   2.3789   2.3605   2.3422   2.3218   2.3023
160.0     2.5061   2.4994   2.4899   2.4784   2.4646   2.4493   2.4322   2.4134   2.3943   2.3755
180.0     2.5841   2.5787   2.5713   2.5609   2.5486   2.5336   2.5176   2.5010   2.4838   2.4662
0.0       2.2821   2.3026   2.3330   2.3708   2.4163   2.4695   2.5286   2.5931   2.6629   2.4820
20.0      2.3299   2.3482   2.3751   2.4101   2.4523   2.5024   2.5590   2.6211   2.6892   2.5227
40.0      2.3762   2.3918   2.4152   2.4477   2.4871   2.5342   2.5882   2.6486   2.7148   2.5341
60.0      2.4203   2.4327   2.4543   2.4827   2.5206   2.5644   2.6166   2.6749   2.7281   2.5163
80.0      2.4614   2.4719   2.4901   2.5175   2.5510   2.5943   2.6434   2.7010   2.6664   2.4707
100.0     2.5017   2.5086   2.5253   2.5488   2.5821   2.6215   2.6704   2.7258   2.5773   2.3560
120.0     2.5375   2.5442   2.5574   2.5805   2.6099   2.6495   2.6957   2.6173   2.4626   2.1372
140.0     2.5728   2.5759   2.5893   2.6091   2.6388   2.6753   2.5875   2.4610   2.2319   1.8740
160.0     2.6049   2.6086   2.6184   2.6313   2.5679   2.4886   2.3931   2.1907   1.8927   1.5975
180.0     2.4040   2.4124   2.4026   2.3723   2.3257   2.2147   2.0151   1.7815   1.5476   1.3505
0.0      -3.0932  -3.1286  -3.1614  -3.1895  -3.2141  -3.2359  -3.2544  -3.2702  -3.2853  -2.9748
20.0     -3.1263  -3.1523  -3.1748  -3.1938  -3.2092  -3.2226  -3.2334  -3.2421  -3.2506  -2.9545
40.0     -3.1574  -3.1738  -3.1862  -3.1967  -3.2034  -3.2082  -3.2114  -3.2134  -3.2149  -2.8962
60.0     -3.1862  -3.1925  -3.1969  -3.1971  -3.1968  -3.1928  -3.1890  -3.1837  -3.1635  -2.8003
80.0     -3.2118  -3.2099  -3.2045  -3.1982  -3.1875  -3.1781  -3.1651  -3.1548  -3.0177  -2.6695
100.0    -3.2370  -3.2250  -3.2125  -3.1962  -3.1807  -3.1610  -3.1441  -3.1242  -2.8388  -2.4507
120.0    -3.2578  -3.2402  -3.2181  -3.1965  -3.1706  -3.1477  -3.1209  -2.9279  -2.6263  -2.1041
140.0    -3.2792  -3.2518  -3.2254  -3.1946  -3.1655  -3.1319  -2.9319  -2.6701  -2.2715  -1.6987
160.0    -3.2979  -3.2668  -3.2307  -3.1873  -3.0340  -2.8507  -2.6330  -2.2727  -1.7782  -1.2834
180.0    -3.0216  -2.9918  -2.9273  -2.8237  -2.6885  -2.4581  -2.1072  -1.6985  -1.2846  -0.9072
0.0       2.1319   2.1791   2.2243   2.2656   2.3038   2.3394   2.3716   2.4009   2.4284   2.2166
20.0      2.1449   2.1907   2.2336   2.2735   2.3099   2.3441   2.3754   2.4038   2.4307   2.2332
40.0      2.1675   2.2114   2.2518   2.2903   2.3251   2.3576   2.3876   2.4154   2.4413   2.2310
60.0      2.1989   2.2402   2.2795   2.3148   2.3490   2.3794   2.4086   2.4352   2.4494   2.2103
80.0      2.2381   2.2777   2.3141   2.3491   2.3799   2.4105   2.4374   2.4641   2.3968   2.1727
100.0     2.2866   2.3226   2.3578   2.3896   2.4208   2.4483   2.4758   2.5007   2.3279   2.0795
120.0     2.3399   2.3756   2.4076   2.4392   2.4675   2.4957   2.5213   2.4221   2.2435   1.8989
140.0     2.4011   2.4331   2.4653   2.4943   2.5232   2.5495   2.4506   2.3073   2.0599   1.6848
160.0     2.4662   2.4983   2.5278   2.5507   2.4936   2.4123   2.3077   2.0940   1.7831   1.4669
180.0     2.3194   2.3563   2.3673   2.3512   2.3103   2.2013   1.9997   1.7587   1.5081   1.2842
=run g4bl test021.in  >test021.out1 2>&1
=grep "^z=" test021.out1 test021.txt
=compare test021.B test021.txt -1 .02 .02 .02 .02 .02 .02 .02 .02 .02 .02
=run g4bl test021.in2 >test021.out2 2>&1
=grep "^z=" test021.out2 test021.txt2
=compare test021.B test021.txt2 -1 .02 .02 .02 .02 .02 .02 .02 .02 .02 .02
