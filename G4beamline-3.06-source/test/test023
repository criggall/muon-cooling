=place OFFSET with 2 solenoids (12 sec)
=require gsl

=file test023.in 
param histoFile=""
physics QGSP doStochastics=0
beam ascii filename=test023.beam nEvents=9
randomseed now 1
coil test023.coil innerRadius=200 outerRadius=300 length=500 \
	material=Cu
solenoid test023.solenoid coilName=test023.coil current=50.0
place OFFSET z=2000
group 2solenoids length=2000
	place test023.solenoid z=-750 current=100
	place test023.solenoid z=750 current=-100
endgroup
place 2solenoids z=0
virtualdetector format=BLTrackFile AF radius=200 length=1 file=test023.txt color=1,1,1
place AF z=2000
printfield type=print field=Bz layout=zx drow=50 dcol=45 \
	nrow=81 ncol=5
=file test023.beam 
#BLTrackFile test023 beam
#x y z Px Py Pz t PDGid EventID TrackID ParentID Weight
#cm cm cm MeV/c MeV/c MeV/c ns - - - - -
0.000 0.000 0.000 0.000 0.000 200.000 0.375 -13 0 1 0 1.0000
0.000 0.000 0.000 5.000 0.000 200.000 0.375 -13 1 1 0 2.0000
0.000 0.000 0.000 0.000 5.000 200.000 0.375 -13 2 1 0 2.0000
0.000 0.000 0.000 5.000 5.000 200.000 0.375 -13 3 1 0 3.0000
0.000 0.000 0.000 -5.000 0.000 200.000 0.375 -13 4 1 0 2.0000
0.000 0.000 0.000 0.000 -5.000 200.000 0.375 -13 5 1 0 2.0000
0.000 0.000 0.000 -5.000 -5.000 200.000 0.375 -13 6 1 0 3.0000
0.000 0.000 0.000 -5.000 5.000 200.000 0.375 -13 7 1 0 3.0000
0.000 0.000 0.000 5.000 -5.000 200.000 0.375 -13 8 1 0 3.0000
=file test023.good 
#BLTrackFile VirtualDetector/AF
#x y z Px Py Pz t PDGid EventID TrackID ParentID Weight
#mm mm mm MeV/c MeV/c MeV/c ns - - - - -
0.00 0.00 3999.50 0.000 0.000 200.000 15.463 -13 0 1 0 1.0000
12.91 0.04 3999.50 -3.867 0.125 200.025 15.510 -13 1 1 0 2.0000
-0.04 12.91 3999.50 -0.125 -3.867 200.025 15.510 -13 2 1 0 2.0000
6.99 6.79 3999.50 -4.539 -4.493 200.023 15.549 -13 3 1 0 3.0000
-12.91 -0.04 3999.50 3.867 -0.125 200.025 15.510 -13 4 1 0 2.0000
0.04 -12.91 3999.50 0.125 3.867 200.025 15.510 -13 5 1 0 2.0000
-6.99 -6.79 3999.50 4.539 4.493 200.023 15.549 -13 6 1 0 3.0000
-6.79 6.99 3999.50 4.493 -4.539 200.023 15.549 -13 7 1 0 3.0000
6.79 -6.99 3999.50 -4.493 4.539 200.023 15.549 -13 8 1 0 3.0000
=file test023.B 
z=0.0       0.0935   0.0931   0.0919   0.0900   0.0874
z=50.0      0.1064   0.1059   0.1044   0.1021   0.0989
z=100.0     0.1218   0.1212   0.1194   0.1165   0.1126
z=150.0     0.1401   0.1393   0.1371   0.1335   0.1286
z=200.0     0.1623   0.1613   0.1585   0.1539   0.1479
z=250.0     0.1890   0.1878   0.1842   0.1784   0.1707
z=300.0     0.2220   0.2204   0.2158   0.2084   0.1985
z=350.0     0.2624   0.2603   0.2543   0.2447   0.2320
z=400.0     0.3134   0.3106   0.3027   0.2901   0.2734
z=450.0     0.3772   0.3735   0.3630   0.3462   0.3242
z=500.0     0.4597   0.4547   0.4404   0.4178   0.3882
z=550.0     0.5655   0.5586   0.5391   0.5082   0.4681
z=600.0     0.7060   0.6964   0.6693   0.6265   0.5710
z=650.0     0.8909   0.8776   0.8397   0.7799   0.7026
z=700.0     1.1434   1.1246   1.0712   0.9866   0.8769
z=750.0     1.4829   1.4569   1.3824   1.2631   1.1067
z=800.0     1.9525   1.9177   1.8165   1.6499   1.4248
z=850.0     2.5806   2.5379   2.4100   2.1883   1.8688
z=900.0     3.4143   3.3713   3.2359   2.9768   2.5465
z=950.0     4.4352   4.4076   4.3144   4.1058   3.6406
z=1000.0    5.5789   5.5846   5.6007   5.6263   5.6599
z=1050.0    6.6964   6.7360   6.8629   7.1251   7.6608
z=1100.0    7.6313   7.6881   7.8625   8.1834   8.6945
z=1150.0    8.3155   8.3752   8.5513   8.8494   9.2683
z=1200.0    8.7085   8.7654   8.9296   9.1961   9.5515
z=1250.0    8.8407   8.8959   9.0542   9.3078   9.6408
z=1300.0    8.6965   8.7535   8.9178   9.1846   9.5403
z=1350.0    8.2913   8.3511   8.5275   8.8261   9.2458
z=1400.0    7.5943   7.6512   7.8261   8.1478   8.6601
z=1450.0    6.6457   6.6855   6.8131   7.0765   7.6138
z=1500.0    5.5133   5.5193   5.5363   5.5635   5.5993
z=1550.0    4.3531   4.3258   4.2340   4.0274   3.5650
z=1600.0    3.3134   3.2709   3.1372   2.8808   2.4541
z=1650.0    2.4583   2.4163   2.2906   2.0723   1.7574
z=1700.0    1.8052   1.7713   1.6728   1.5106   1.2914
z=1750.0    1.3061   1.2813   1.2103   1.0967   0.9478
z=1800.0    0.9311   0.9138   0.8650   0.7877   0.6877
z=1850.0    0.6357   0.6244   0.5924   0.5421   0.4775
z=1900.0    0.3973   0.3905   0.3712   0.3410   0.3022
z=1950.0    0.1906   0.1874   0.1784   0.1643   0.1462
z=2000.0    0.0000   0.0000   0.0000   0.0000   0.0000
z=2050.0   -0.1906  -0.1874  -0.1784  -0.1643  -0.1462
z=2100.0   -0.3973  -0.3905  -0.3712  -0.3410  -0.3022
z=2150.0   -0.6357  -0.6244  -0.5924  -0.5421  -0.4775
z=2200.0   -0.9311  -0.9138  -0.8650  -0.7877  -0.6877
z=2250.0   -1.3061  -1.2813  -1.2103  -1.0967  -0.9478
z=2300.0   -1.8052  -1.7713  -1.6728  -1.5106  -1.2914
z=2350.0   -2.4583  -2.4163  -2.2906  -2.0723  -1.7574
z=2400.0   -3.3134  -3.2709  -3.1372  -2.8808  -2.4541
z=2450.0   -4.3531  -4.3258  -4.2340  -4.0274  -3.5650
z=2500.0   -5.5133  -5.5193  -5.5363  -5.5635  -5.5993
z=2550.0   -6.6457  -6.6855  -6.8131  -7.0765  -7.6138
z=2600.0   -7.5943  -7.6512  -7.8261  -8.1478  -8.6601
z=2650.0   -8.2913  -8.3511  -8.5275  -8.8261  -9.2458
z=2700.0   -8.6965  -8.7535  -8.9178  -9.1846  -9.5403
z=2750.0   -8.8407  -8.8959  -9.0542  -9.3078  -9.6408
z=2800.0   -8.7085  -8.7654  -8.9296  -9.1961  -9.5515
z=2850.0   -8.3155  -8.3752  -8.5513  -8.8494  -9.2683
z=2900.0   -7.6313  -7.6881  -7.8625  -8.1834  -8.6945
z=2950.0   -6.6964  -6.7360  -6.8629  -7.1251  -7.6608
z=3000.0   -5.5789  -5.5846  -5.6007  -5.6263  -5.6599
z=3050.0   -4.4352  -4.4076  -4.3144  -4.1058  -3.6406
z=3100.0   -3.4143  -3.3713  -3.2359  -2.9768  -2.5465
z=3150.0   -2.5806  -2.5379  -2.4100  -2.1883  -1.8688
z=3200.0   -1.9525  -1.9177  -1.8165  -1.6499  -1.4248
z=3250.0   -1.4829  -1.4569  -1.3824  -1.2631  -1.1067
z=3300.0   -1.1434  -1.1246  -1.0712  -0.9866  -0.8769
z=3350.0   -0.8909  -0.8776  -0.8397  -0.7799  -0.7026
z=3400.0   -0.7060  -0.6964  -0.6693  -0.6265  -0.5710
z=3450.0   -0.5655  -0.5586  -0.5391  -0.5082  -0.4681
z=3500.0   -0.4597  -0.4547  -0.4404  -0.4178  -0.3882
z=3550.0   -0.3772  -0.3735  -0.3630  -0.3462  -0.3242
z=3600.0   -0.3134  -0.3106  -0.3027  -0.2901  -0.2734
z=3650.0   -0.2624  -0.2603  -0.2543  -0.2447  -0.2320
z=3700.0   -0.2220  -0.2204  -0.2158  -0.2084  -0.1985
z=3750.0   -0.1890  -0.1878  -0.1842  -0.1784  -0.1707
z=3800.0   -0.1623  -0.1613  -0.1585  -0.1539  -0.1479
z=3850.0   -0.1401  -0.1393  -0.1371  -0.1335  -0.1286
z=3900.0   -0.1218  -0.1212  -0.1194  -0.1165  -0.1126
z=3950.0   -0.1064  -0.1059  -0.1044  -0.1021  -0.0989
z=4000.0   -0.0935  -0.0931  -0.0919  -0.0900  -0.0874
=run g4bl test023.in 
=grep "^z=" g4bl.out test023.try
=compare test023.B test023.try -1 0.01 0.01 0.01 0.01 0.01
=compare test023.txt test023.good 0.1 0.1 0.1 0.1 0.1 0.1 0.1
